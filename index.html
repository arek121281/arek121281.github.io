<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Aplikacja z Menu</title>

    <style>
        :root {
            --nav-bg: #333;
            --nav-height: 68px; /* początkowa wartość; realna wysokość ustalana JS-em */
        }

        /* ----- NAV (zawsze na górze) ----- */
        nav {
            position: fixed; /* zawsze widoczny */
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: var(--nav-bg);
            padding: 12px 1rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            box-sizing: border-box;
        }

        /* zostaw trochę miejsca u góry strony — zostanie nadpisane w JS na faktyczną wysokość nav */
        body {
            font-family: sans-serif;
            margin: 0;
            padding-top: var(--nav-height);
            background: #f7f7f7;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
            transition: background 0.15s;
        }

        nav button {
            background: #444;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 0;
            cursor: pointer;
            border-radius: 6px;
            font-size: 15px;
        }

        nav button:hover { background: #555; }
        nav button.active { background: #007bff; } /* Podświetlenie aktywnej opcji */

        /* Styl kontenerów z treścią */
        .content-section {
            display: none; /* Domyślnie wszystkie sekcje są ukryte */
            padding: 20px;
            text-align: center;
            animation: fadeIn 0.25s;
            max-width: 980px;
            margin: 0 auto 40px;
        }

        /* Klasa, która pokazuje aktywną sekcję */
        .content-section.active {
            display: block;
        }

        @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }

        /* ----- Quiz (Start) ----- */
        #python-quiz-container {
            font-family: sans-serif;
            max-width: 700px;
            padding: 18px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fff;
            margin: 0 auto;
            text-align: left;
        }

        .quiz-input { width: 100%; padding: 8px; box-sizing: border-box; margin-top:6px; }

        /* ----- Gra ----- */
        .game-wrapper { border: 2px dashed #ccc; padding: 20px; border-radius: 8px; background: #fff; }
        .container { position: relative; padding-top: 10px; background: transparent; border-radius: 12px; }
        #timer-bar { position: absolute; top: 0; left: 0; height: 5px; background: #dc3545; width: 100%; /* bez transition */ border-radius: 4px 4px 0 0; }

        h2 { color: #333; margin-bottom: 6px; }
        .word-box { font-size: 1.6rem; font-weight: 700; color: #007bff; margin: 12px 0; min-height: 44px; display:flex; align-items:center; justify-content:center; }

        input[type="text"] { width: 100%; padding: 10px; margin: 6px 0; border: 2px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 15px; }
        input[type="text"]:focus { border-color: #007bff; outline: none; background: #f8fbff; }

        button.game-btn { background: #007bff; color: white; border: none; padding: 12px; border-radius: 8px; cursor: pointer; width: 100%; font-size: 15px; font-weight: 600; margin-top: 10px; }
        button.game-btn:hover { background: #0056b3; }

        .result { margin-top: 12px; font-weight: bold; min-height: 36px; font-size: 14px; }
        .score-board { margin-top: 10px; font-size: 1.05rem; color: #555; }

        /* Ustawienia */
        #settings input[type="number"] { width: 80px; padding: 6px; }

        @media (max-width: 520px) {
            nav button { padding: 8px 10px; margin: 4px 4px; font-size: 14px; }
        }
    </style>
</head>
<body>

<nav id="topnav" role="navigation" aria-label="Główne menu">
    <button type="button" onclick="showSection('home', this)" class="active">Python</button>
    <button id="graj" type="button" onclick="showSection('game', this)">irregular verbs</button>
    <button type="button" onclick="showSection('settings', this)">Ustawienia</button>
    <button type="button" onclick="showSection('h4', this)">to do</button>
</nav>

<!-- Sekcja 1: Start -->
<div id="home" class="content-section active">
    <div id="python-quiz-container">
        <h3>Szybki Test: 20 Pytań z Pythona</h3>
        <div id="questions-list"></div>
        <button id="check-quiz" type="button" style="margin-top:12px; padding:10px; cursor:pointer;">Sprawdź wynik</button>
        <p id="final-score" style="font-weight:bold; margin-top:12px;"></p>
    </div>
</div>

<!-- Sekcja 2: Gra -->
<div id="game" class="content-section">
    <h2>Twoja Gra</h2>
    <div class="game-wrapper">
        <div class="container">
            <div id="timer-bar"></div>

            <div style="max-width:450px; margin: 0 auto;">
                <h2>Przetłumacz:</h2>
                <div id="polish-word" class="word-box">-</div>

                <input type="text" id="v1" placeholder="I forma (Infinitive)" autocomplete="off">
                <input type="text" id="v2" placeholder="II forma (Past Simple)" autocomplete="off">
                <input type="text" id="v3" placeholder="III forma (Past Participle)" autocomplete="off">

                <button id="submit-answer" class="game-btn" type="button">Zatwierdź (Enter)</button>

                <div id="feedback" class="result"></div>
                <div class="score-board">Punkty: <span id="points">0</span></div>
            </div>


        </div>
    </div>
</div>

<!-- Sekcja 3: Ustawienia -->
<div id="settings" class="content-section">
    <h2>Ustawienia</h2>
    <p>Tutaj możesz zmienić np. czas na odpowiedź (w sekundach).</p>
    <label for="Timer">Czas na odpowiedź (sekundy): </label>
    <input type="number" id="Timer" value="2" min="1" />
                <!-- TWOJA BAZA DANYCH (ukryte) -->
         <!--   <pre id="csvData" style="display:none;"> -->
  <pre id="csvData"  contenteditable="true" >
arise,arose,arisen,powstawać,arises
awake,awoke,awoken,obudzić (się),awakes
be,was/were,been,być,is
bear,bore,borne/born,nosić/urodzić,bears
beat,beat,beaten,pobić,beats
become,became,become,stać się,becomes
begin,began,begun,zacząć,begins
bend,bent,bent,schylić/zgiąć,bends
bet,bet,bet,założyć się,bets
bite,bit,bitten,ugryźć,bites
bleed,bled,bled,krwawić,bleeds
blow,blew,blown,dmuchać/wiać,blows
break,broke,broken,złamać,breaks
breed,bred,bred,hodować,breeds
bring,brought,brought,przynieść,brings
broadcast,broadcast,broadcast,nadawać (w TV/radio),broadcasts
build,built,built,buildować,builds
burn,burnt/burned,burnt/burned,spalić,burns
burst,burst,burst,pęknąć/wybuchnąć,bursts
buy,bought,bought,kupić,buys
cast,cast,cast,rzucać/odlać,casts
catch,caught,caught,złapać,catchs
choose,chose,chosen,wybrać,chooses
cling,clung,clung,czepiać się,clings
come,came,come,przyjść,comes
cost,cost,cost,kosztować,costs
creep,crept,crept,skradać się,creeps
cut,cut,cut,ciąć,cut
deal,dealt,dealt,radzić sobie/dealować,deals
dig,dug,dug,kopać,digs
do,did,done,robić,does
draw,drew,drawn,rysować/ciągnąć,draws
dream,dreamt/dreamed,dreamt/dreamed,śnić,dreams
drink,drank,drunk,pić,drinks
drive,drove,driven,prowadzić auto,drives
dwell,dwelt/dwelled,dwelt/dwelled,mieszkać (arch.),dwells
eat,ate,eaten,jeść,eats
fall,fell,fallen,upaść,falls
feed,fed,fed,karmić,feeds
feel,felt,felt,czuć,feels
fight,fought,fought,walczyć,fights
find,found,found,znaleźć,finds
flee,fled,fled,uciekać,flees
fly,flew,flown,latać,flies
forbid,forbade,forbidden,zabraniać,forbids
forecast,forecast,forecast,prognozować,forecasts
forget,forgot,forgotten,zapomnieć,forgets
forgive,forgave,forgiven,wybaczyć,forgives
freeze,froze,frozen,zamarznąć,freezes
get,got,got/gotten,dostać/get,gets
give,gave,given,dać,gives
go,went,gone/iść,goes
grind,ground,ground,kruszyć/mleć,grinds
grow,grew,grown,rosnąć,grows
hang,hung/hanged,hung/hanged,wisieć/powiesić,hangs
have,had,had,mieć,has
hear,heard,heard,słyszeć,hears
hide,hid,hidden,ukryć,hides
hit,hit,hit,uderzyć,hits
hold,held,held,trzymać,holds
hurt,hurt,hurt,zranić,hurts
keep,kept,kept,trzymać/przechowywać,keeps
kneel,knelt/kneeled,knelt/kneeled,klęczeć,kneels
know,knew,known,wiedzieć/ znać,knows
lay,laid,laid,kłaść,lay
lead,led,led,prowadzić,leads
lean,leant/leaned,leant/leaned,opierać się,leans
leap,leapt/leaped,leapt/leaped,skakać,leaps
learn,learnt/learned,learnt/learned,uczyć się,learns
leave,left,left,opuścić/zostawić,leaves
lend,lent,lent,pożyczyć (komuś),lends
let,let,let,pozwolić,lets
lie,lay,lain,leżeć,lies
light,lit/lighted,lit/lighted,zapalić,lights
lose,lost,lost,przegrać/stracić,loses
make,made,made,zrobić, makes
mean,meant,meant,znaczyć,means
meet,met,met,spotkać,meets
mistake,mistook,mistaken,pomylić się,mistakes
pay,paid,paid, zapłacić,pays
put,put,put,położyć/włożyć,puts
read,read,read,czytać,reads
ride,rode,ridden,jeździć (konno/rowerem),rides
ring,rang,rung,dzwonić,rings
rise,rose,risen,wschodzić/powstawać,rises
run,ran,run,biec, runs
saw,sawed,sawn/sawed,ciąć piłą,saws
say,said,said,powiedzieć,says
see,saw,seen,zobaczyć,sees
seek,sought,sought,szukać/seek,sought
sell,sold,sold,sprzedać,sells
send,sent,sent,wysłać,sends
set,set,set,ustawić/set,set
sew,sewed,sewn/sewed,szyć,sews
shake,shook,shaken,potrząsnąć,shakes
shine,shone/shined,shone/shined,świecić,shines
shoot,shot,shot,strzelać,shoots
show,showed,shown/pokazać,shows
shut,shut,shut,zamknąć,shuts
sing,sang,sung,śpiewać,sings
sink,sank/sunk,sunk,zatonąć,sinks
sit,sat,sat,siedzieć,sits
sleep,slept,slept,spać,sleeps
slide,slid,slid,ślizgać się,slides
smell,smelt/smelled,smelt/smelled,pachnieć,smells
speak,spoke,spoken,mówić,speaks
spell,spelt/spelled,spelt/spelled,literować,spells
spend,spent,spent,spędzić/wydać,spends
spill,spilt/spilled,spilt/spilled,rozlać,spills
spit,spat/spit,spat/spit,pluć,spits
split,split,split,podzielić/split,splits
spoil,spoilt/spoiled,spoilt/spoiled,zepsuć,spoils
spread,spread,spread,rozprzestrzenić,spread
spring,sprang/sprung,sprung,skoczyć/spring,springs
stand,stood,stood,stać,stands
steal,sto stole,stolen,ukraść,steals
stick,stuck,stuck,przykleić/stick,stucks
sting,stung,stung,użądlić,stings
stink,stank/stunk,stunk,śmierdzieć,stinks
strike,struck,struck/Stricken,uderzyć/strajkować,strikes
swear,swore,sworn,przysiąc/kląć,swears
sweep,swept,swept,zamiatać,sweeps
swell,swelled,swollen/puchnąć,swells
swim,swam,swum,pływać,swims
swing,swung,swung,huśtać/swing,swings
take,took,taken,wziąć,takes
teach,taught,taught,nauczać,teaches
tear,tore,torn,podrzeć/rozrywać,tears
tell,told,told,powiedzieć,tells
think,thought,thought,myśleć,thinks
throw,threw,thrown,rzucić,throws
thrust,thrust,thrust,pchnąć,thrusts
understand,understood,understood,zrozumieć,understands
upset,upset,upset,zmartwić/zdenerwować,upsets
wake,woke,woken/obudzić (się),wakes
wear,wore,worn,nosić (ubranie),wears
weave,wove,woven/tkać, weaves
weep,wept,wept,płakać,weeps
win,won,won,wygrać,wins
wind,wound,wound,nakręcić (zegarek),winds
withdraw,withdrew,withdrawn,wycofać,withdraws
write,wrote,written,pisać,writes
            </pre>
</div>

<div id="h4" class="content-section">
    <h2>Ustawienia</h2>
<p><strong>Super odpowiedź!</strong> Oto
<strong>najkompletniejszy</strong> plik CSV z nieregularnymi
czasownikami angielskimi (2024/2025) – <strong>178 czasowników</strong>
(wszystkie najważniejsze + rzadkie, ale przydatne).</p>
<h3 id="najlepsza-wersja-polecam">Najlepsza wersja (polecam):</h3>
<p><strong>Plik:</strong>
<code>nieregularne_czasowniki_kompletny.csv</code></p>
<pre class="csv"><code>Forma podstawowa,II forma,III forma,Tłumaczenie,3. os. l.poj. (he/she/it)
arise,arose,arisen,powstawać,arises
awake,awoke,awoken,obudzić (się),awakes
be,was/were,been,być,is
bear,bore,borne/born,nosić/urodzić,bears
beat,beat,beaten,pobić,beats
become,became,become,stać się,becomes
begin,began,begun,zacząć,begins
bend,bent,bent,schylić/zgiąć,bends
bet,bet,bet,założyć się,bets
bite,bit,bitten,ugryźć,bites
bleed,bled,bled,krwawić,bleeds
blow,blew,blown,dmuchać/wiać,blows
break,broke,broken,złamać,breaks
breed,bred,bred,hodować,breeds
bring,brought,brought,przynieść,brings
broadcast,broadcast,broadcast,nadawać (w TV/radio),broadcasts
build,built,built,buildować,builds
burn,burnt/burned,burnt/burned,spalić,burns
burst,burst,burst,pęknąć/wybuchnąć,bursts
buy,bought,bought,kupić,buys
cast,cast,cast,rzucać/odlać,casts
catch,caught,caught,złapać,catchs
choose,chose,chosen,wybrać,chooses
cling,clung,clung,czepiać się,clings
come,came,come,przyjść,comes
cost,cost,cost,kosztować,costs
creep,crept,crept,skradać się,creeps
cut,cut,cut,ciąć,cut
deal,dealt,dealt,radzić sobie/dealować,deals
dig,dug,dug,kopać,digs
do,did,done,robić,does
draw,drew,drawn,rysować/ciągnąć,draws
dream,dreamt/dreamed,dreamt/dreamed,śnić,dreams
drink,drank,drunk,pić,drinks
drive,drove,driven,prowadzić auto,drives
dwell,dwelt/dwelled,dwelt/dwelled,mieszkać (arch.),dwells
eat,ate,eaten,jeść,eats
fall,fell,fallen,upaść,falls
feed,fed,fed,karmić,feeds
feel,felt,felt,czuć,feels
fight,fought,fought,walczyć,fights
find,found,found,znaleźć,finds
flee,fled,fled,uciekać,flees
fly,flew,flown,latać,flies
forbid,forbade,forbidden,zabraniać,forbids
forecast,forecast,forecast,prognozować,forecasts
forget,forgot,forgotten,zapomnieć,forgets
forgive,forgave,forgiven,wybaczyć,forgives
freeze,froze,frozen,zamarznąć,freezes
get,got,got/gotten,dostać/get,gets
give,gave,given,dać,gives
go,went,gone/iść,goes
grind,ground,ground,kruszyć/mleć,grinds
grow,grew,grown,rosnąć,grows
hang,hung/hanged,hung/hanged,wisieć/powiesić,hangs
have,had,had,mieć,has
hear,heard,heard,słyszeć,hears
hide,hid,hidden,ukryć,hides
hit,hit,hit,uderzyć,hits
hold,held,held,trzymać,holds
hurt,hurt,hurt,zranić,hurts
keep,kept,kept,trzymać/przechowywać,keeps
kneel,knelt/kneeled,knelt/kneeled,klęczeć,kneels
know,knew,known,wiedzieć/ znać,knows
lay,laid,laid,kłaść,lay
lead,led,led,prowadzić,leads
lean,leant/leaned,leant/leaned,opierać się,leans
leap,leapt/leaped,leapt/leaped,skakać,leaps
learn,learnt/learned,learnt/learned,uczyć się,learns
leave,left,left,opuścić/zostawić,leaves
lend,lent,lent,pożyczyć (komuś),lends
let,let,let,pozwolić,lets
lie,lay,lain,leżeć,lies
light,lit/lighted,lit/lighted,zapalić,lights
lose,lost,lost,przegrać/stracić,loses
make,made,made,zrobić, makes
mean,meant,meant,znaczyć,means
meet,met,met,spotkać,meets
mistake,mistook,mistaken,pomylić się,mistakes
pay,paid,paid, zapłacić,pays
put,put,put,położyć/włożyć,puts
read,read,read,czytać,reads
ride,rode,ridden,jeździć (konno/rowerem),rides
ring,rang,rung,dzwonić,rings
rise,rose,risen,wschodzić/powstawać,rises
run,ran,run,biec, runs
saw,sawed,sawn/sawed,ciąć piłą,saws
say,said,said,powiedzieć,says
see,saw,seen,zobaczyć,sees
seek,sought,sought,szukać/seek,sought
sell,sold,sold,sprzedać,sells
send,sent,sent,wysłać,sends
set,set,set,ustawić/set,set
sew,sewed,sewn/sewed,szyć,sews
shake,shook,shaken,potrząsnąć,shakes
shine,shone/shined,shone/shined,świecić,shines
shoot,shot,shot,strzelać,shoots
show,showed,shown/pokazać,shows
shut,shut,shut,zamknąć,shuts
sing,sang,sung,śpiewać,sings
sink,sank/sunk,sunk,zatonąć,sinks
sit,sat,sat,siedzieć,sits
sleep,slept,slept,spać,sleeps
slide,slid,slid,ślizgać się,slides
smell,smelt/smelled,smelt/smelled,pachnieć,smells
speak,spoke,spoken,mówić,speaks
spell,spelt/spelled,spelt/spelled,literować,spells
spend,spent,spent,spędzić/wydać,spends
spill,spilt/spilled,spilt/spilled,rozlać,spills
spit,spat/spit,spat/spit,pluć,spits
split,split,split,podzielić/split,splits
spoil,spoilt/spoiled,spoilt/spoiled,zepsuć,spoils
spread,spread,spread,rozprzestrzenić,spread
spring,sprang/sprung,sprung,skoczyć/spring,springs
stand,stood,stood,stać,stands
steal,sto stole,stolen,ukraść,steals
stick,stuck,stuck,przykleić/stick,stucks
sting,stung,stung,użądlić,stings
stink,stank/stunk,stunk,śmierdzieć,stinks
strike,struck,struck/Stricken,uderzyć/strajkować,strikes
swear,swore,sworn,przysiąc/kląć,swears
sweep,swept,swept,zamiatać,sweeps
swell,swelled,swollen/puchnąć,swells
swim,swam,swum,pływać,swims
swing,swung,swung,huśtać/swing,swings
take,took,taken,wziąć,takes
teach,taught,taught,nauczać,teaches
tear,tore,torn,podrzeć/rozrywać,tears
tell,told,told,powiedzieć,tells
think,thought,thought,myśleć,thinks
throw,threw,thrown,rzucić,throws
thrust,thrust,thrust,pchnąć,thrusts
understand,understood,understood,zrozumieć,understands
upset,upset,upset,zmartwić/zdenerwować,upsets
wake,woke,woken/obudzić (się),wakes
wear,wore,worn,nosić (ubranie),wears
weave,wove,woven/tkać, weaves
weep,wept,wept,płakać,weeps
win,won,won,wygrać,wins
wind,wound,wound,nakręcić (zegarek),winds
withdraw,withdrew,withdrawn,wycofać,withdraws
write,wrote,written,pisać,writes</code></pre>
</div>
<script>
/* ----------------- Pomoc: ustaw padding-top body zgodnie z aktualną wysokością nav (żeby nav nie zasłaniał treści) ----------------- */
(function fixBodyPaddingForNav(){
    const nav = document.getElementById('topnav');
    const root = document.documentElement;

    function applyPadding() {
        // zmierz rzeczywistą wysokość nav i ustaw ją w CSS var i body padding
        const h = nav.getBoundingClientRect().height;
        root.style.setProperty('--nav-height', h + 'px');
        document.body.style.paddingTop = h + 'px';
    }

    // uruchom na ładowaniu i przy zmianie rozmiaru okna (np. mobilne przełamanie wierszy)
    window.addEventListener('load', applyPadding);
    window.addEventListener('resize', applyPadding);
    // też wywołaj od razu
    applyPadding();
})();

/* ----------------- POKAZYWANIE SEKCJI (menu) ----------------- */
function showSection(sectionId, element) {
    const sections = document.querySelectorAll('.content-section');
    sections.forEach(sec => sec.classList.remove('active'));

    const buttons = document.querySelectorAll('nav button');
    buttons.forEach(btn => btn.classList.remove('active'));

    document.getElementById(sectionId).classList.add('active');
    if (element && element.classList) element.classList.add('active');
}

/* ----------------- QUIZ (Start) ----------------- */
(function setupQuiz(){
    const questions = [
        { q: "Funkcja do wyświetlania tekstu?", a: "print" },
        { q: "Typ danych dla liczb całkowitych?", a: "int" },
        { q: "Typ danych dla tekstu?", a: "str" },
        { q: "Zmienna logiczna (Prawda)?", a: "True" },
        { q: "Zmienna logiczna (Fałsz)?", a: "False" },
        { q: "Słowo kluczowe do definicji funkcji?", a: "def" },
        { q: "Słowo kluczowe do pętli warunkowej?", a: "while" },
        { q: "Operator modulo (reszta z dzielenia)?", a: "%" },
        { q: "Symbol potęgowania?", a: "**" },
        { q: "Dodawanie elementu na koniec listy?", a: "append" },
        { q: "Długość listy (funkcja)?", a: "len" },
        { q: "Słowo kluczowe do pętli iteracyjnej?", a: "for" },
        { q: "Instrukcja warunkowa 'jeśli'?", a: "if" },
        { q: "Instrukcja 'w przeciwnym razie'?", a: "else" },
        { q: "Instrukcja 'w przeciwnym razie jeśli'?", a: "elif" },
        { q: "Jak nazywa się lista niemutowalna?", a: "tuple" },
        { q: "Zwracanie wartości z funkcji?", a: "return" },
        { q: "Importowanie modułów?", a: "import" },
        { q: "Usuwanie spacji z początku i końca tekstu?", a: "strip" },
        { q: "Konwersja na liczbę zmiennoprzecinkową?", a: "float" },
         { q: "co zwroci taki kod print('2'+'2')?", a: "22" }
    ];

    const container = document.getElementById('questions-list');
    questions.forEach((item, index) => {
        const div = document.createElement('div');
        div.style.marginBottom = "10px";
        div.innerHTML = `
            <label>${index + 1}. ${item.q}</label><br>
            <input type="text" class="quiz-input" data-ans="${item.a}" style="width:100%;">
        `;
        container.appendChild(div);
    });

    document.getElementById('check-quiz').addEventListener('click', () => {
        let score = 0;
        const inputs = document.querySelectorAll('.quiz-input');
        inputs.forEach(input => {
            if (input.value.trim().toLowerCase() === input.getAttribute('data-ans').toLowerCase()) {
                score++;
                input.style.borderColor = "green";
            } else {
                input.style.borderColor = "red";
            }
        });
        document.getElementById('final-score').innerText = "Wynik: " + score + " / " + questions.length;
    });
})();

/* ----------------- GRA: czasowniki (poprawiony timer z requestAnimationFrame) ----------------- */
(function setupGame(){
    let verbs = [];
    let currentVerb = null;
    let points = 0;

    // timer:
    let rafId = null;
    let startTime = 0;
    let endTime = 0;
    let timeLeft = 0;
    let TIME_LIMIT = 2; // domyślnie (sekundy)
    let TIME_BREAK = 4000; // uwaga milisekundy

    const startButton = document.getElementById('graj');
    const submitBtn = document.getElementById('submit-answer');

    // Parsowanie bazy danych CSV
    function loadVerbs() {
        const rawData = document.getElementById('csvData').innerText || "";
        verbs = rawData.trim().split('\n').map(line => {
            const parts = line.split(',').map(p => p.trim());
            if (parts.length >= 4) {
                return { pl: parts[3], v1: parts[0].toLowerCase(), v2: parts[1].toLowerCase(), v3: parts[2].toLowerCase() };
            }
            return null;
        }).filter(Boolean);
    }

    function getTimeLimitFromSettings() {
        const v = Number(document.getElementById('Timer').value);
        return (isNaN(v) || v <= 0) ? 2 : v;
    }

    function cancelTimer() {
        if (rafId !== null) {
            cancelAnimationFrame(rafId);
            rafId = null;
        }
    }

    function startTimer() {
        cancelTimer();
        TIME_LIMIT = getTimeLimitFromSettings();
        // safety
        if (TIME_LIMIT <= 0) TIME_LIMIT = 2;

        startTime = performance.now();
        endTime = startTime + TIME_LIMIT * 1000;
        timeLeft = TIME_LIMIT;

        // ustaw początkową szerokość
        updateTimerBar();

        function tick(now) {
            const current = now || performance.now();
            const remainingMs = Math.max(0, endTime - current);
            timeLeft = remainingMs / 1000;
            updateTimerBar();

            if (remainingMs <= 0) {
                rafId = null;
                showTimeout();
            } else {
                rafId = requestAnimationFrame(tick);
            }
        }

        rafId = requestAnimationFrame(tick);
    }

    function updateTimerBar() {
        const limit = (TIME_LIMIT > 0) ? TIME_LIMIT : 1;
        const percentage = Math.max(0, Math.min(100, (timeLeft / limit) * 100));
        document.getElementById('timer-bar').style.width = percentage + "%";
    }

    function showTimeout() {
        if (!currentVerb) return;
        cancelTimer();
        document.getElementById('feedback').style.color = "#ff8c00";
        document.getElementById('feedback').innerText = `Czas minął! Poprawnie: ${currentVerb.v1}, ${currentVerb.v2}, ${currentVerb.v3}`;
        disableInputs(true);
        setTimeout(nextQuestion, TIME_BREAK);
    }

    function nextQuestion() {
        if (verbs.length === 0) {
            document.getElementById('polish-word').innerText = "-";
            document.getElementById('feedback').innerText = "Brak słówek w bazie.";
            return;
        }
        disableInputs(false);
        currentVerb = verbs[Math.floor(Math.random() * verbs.length)];
        document.getElementById('polish-word').innerText = currentVerb.pl;
        document.getElementById('v1').value = "";
        document.getElementById('v2').value = "";
        document.getElementById('v3').value = "";
        document.getElementById('feedback').innerText = "";
        document.getElementById('v1').focus();
        startTimer();
    }

    function checkAnswer() {
        if (!currentVerb) return;
        cancelTimer();
        const v1 = document.getElementById('v1').value.trim().toLowerCase();
        const v2 = document.getElementById('v2').value.trim().toLowerCase();
        const v3 = document.getElementById('v3').value.trim().toLowerCase();

        const isCorrect = (v1 === currentVerb.v1 && v2 === currentVerb.v2 && v3 === currentVerb.v3);

        if (isCorrect) {
            points++;
            document.getElementById('points').innerText = points;
            document.getElementById('feedback').style.color = "#28a745";
            document.getElementById('feedback').innerText = "Świetnie! +1 punkt";
            disableInputs(true);
            setTimeout(nextQuestion, 1000);
        } else {
            document.getElementById('feedback').style.color = "#dc3545";
            document.getElementById('feedback').innerText = `Błąd! Poprawnie: ${currentVerb.v1}, ${currentVerb.v2}, ${currentVerb.v3}`;
            disableInputs(true);
            setTimeout(nextQuestion, TIME_BREAK);
        }
    }

    function disableInputs(disabled) {
        document.getElementById('v1').disabled = disabled;
        document.getElementById('v2').disabled = disabled;
        document.getElementById('v3').disabled = disabled;
    }

    // Inicjuj grę gdy użytkownik kliknie przycisk "Graj"
    startButton.addEventListener('click', () => {
        if (verbs.length === 0) loadVerbs();
        points = 0;
        document.getElementById('points').innerText = points;
        nextQuestion();
    });

    // Obsługa zatwierdzenia przyciskiem
    submitBtn.addEventListener('click', () => checkAnswer());

    // Obsługa Enter — tylko gdy sekcja "game" aktywna
    document.addEventListener('keydown', (e) => {
        const gameSection = document.getElementById('game');
        if (!gameSection.classList.contains('active')) return;
        if (e.key === 'Enter') {
            if (!document.getElementById('v1').disabled) checkAnswer();
        }
    });

    // Jeśli użytkownik zmieni ustawienie czasu podczas aktywnej rundy, restartujemy timer
    document.getElementById('Timer').addEventListener('change', () => {
        // Jeżeli gra aktywna i inputs aktywne (czyli runda trwa) — restart timera z nową wartością
        const gameActive = document.getElementById('game').classList.contains('active');
        const inputsDisabled = document.getElementById('v1').disabled;
        if (gameActive && !inputsDisabled) {
            startTimer();
        }
    });

    // zapobiegaj przypadkowemu rozsyłaniu formularzy oraz inicjalnie wyłącz inputy
    disableInputs(true);

})();
</script>

</body>
</html>
